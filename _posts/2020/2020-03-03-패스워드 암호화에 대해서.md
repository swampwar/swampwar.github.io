---
layout: post
title: 패스워드 암호화에 대해서
tags: [패스워드, 암호화, SHA-256, Salt]
---

# 패스워드 암호화에 대해서

## 패스워드 암호화의 이유
패스워드를 평문으로 저장하면 안 되는 이유는 데이터가 노출되었을 때 저장된 패스워드를 알아볼 수 없게 하기 위함이다. DB가 직접적으로 뚫렸거나, 
DB를 덤프한 파일이 유출되었거나 등 데이터가 유출되는 경로는 무수히 많다. 

## 단방향 암호화 vs 양방향 암호화
단방향 암호화는 평문을 암호화한 값만 저장하고 복호화는 하지 않는(할 수 없는) 것이다. 공격으로 데이터가 뚫렸을 때 복호화가 불가능한 암호화문만 노출되므로 안전하다. 
하지만 양방향 암호화의 경우 데이터와 함께 알고리즘과 키값이 함께 노출된다면 모든 데이터를 복호화할 수 있음으로 평문으로 저장한 것과 다르지 않게 된다. 
그래서 비밀번호와 같이 암호화가 필요한 데이터는 보통 SHA-256을 포함한 단방향 해쉬 함수를 써서 저장한다. 
사용자가 로그인을 시도하면 입력한 값의 암호화문과 저장된 암호화문을 비교하여 판단한다.

## 해시의 크랙
복호화가 어려운 해시함수를 사용하여 데이터를 저장한다 해도 100% 안전한 것은 아니다. 
하드웨어의 발전으로 연산시간이 짧아짐에 따라 무차별적으로 때려 넣는 `Brute Force Attack`으로 뚫릴 수도 있다. 
또한 해쉬 알고리즘이 복잡하여 `Brute Force Attack`으로는 시간이 오래 걸린다 하더라도 미리 가능한 패스워드 조합을 계산한 테이블(`Rainbow Table`)을 가지고 단순 비교만 수행하면 알고리즘의 복잡도와는 상관없이 빠른시간 안에 해킹될 가능성이 크다. 

## Salt Password
해쉬의 가장 큰 적인 `Rainbow Table` 에 대항하기 위한 효과적인 방법은 패스워드에 salt값(해싱에 추가하기 위한 임의의 값)을 추가하는 것이다.  
평문 + salt 의 조합으로 해쉬값을 생성하기 때문에 `Rainbow Table`의 경우의 수를 엄청나게 늘리게 된다. 
여기에 salt값의 길이도 최소 128bit 이상에 고정값이 아니라 랜덤값으로 사용한다면 더욱 안전해진다.

## 알고리즘
데이터를 공격하기 위한 노력과 비례하여 보호하기 위한 방법도 여러 가지가 있으며 이미 예전부터 많이 사용되는 암호화 알고리즘들이 개발되어 있다. 그중에서 골라 쓰면 된다!  
추천 알고리즘 : PBKDF2, bcrypt, scrypt

## SHA-256 (참고용으로 간단정리)
SHA(Secure Hash Algorithm)의 한 종류로 256비트로 구성되며 64자리 문자열을 반환한다. 경우의 수가 2^256 이므로 무차별 대입을 통한 공격에 비교적 안전하다.(SHA-512의 경우의 수는 2^512)  
아주 작은 확률로 입력값이 다름에도 출력값이 같은 경우가 있으며 이를 `충돌`이라고 한다. 충돌의 발생 확률이 낮을수록 좋은 함수로 평가된다.  
단방향(One-Way) 방식의 암호화기 때문에 암호화된 값을 다시 복호화 하는 것은 불가능하다.